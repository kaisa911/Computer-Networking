# 第一章： 计算机网络和因特网

提纲：

1. 什么是 Internet ?
2. 什么是协议?
3. 网络边缘
4. 网络核心:分组交换、线路交换
5. Internet/ISP 结构
6. 性能:丢包、延时、吞吐量
7. 协议层次、服务模型
8. 历史
9. 小结

## 1. 什么是 Internet

**_从具体构成角度_**：因特网是一个世界范围的计算机网络，即它是一个互联了遍及全世界数十亿计算设备
的网络。

用因特网术语来说，所有这些计算设备都称为**主机(host)**或**端系统(end system)**

**端系统**通过**通信链路(communication link)**和**分组交换机(packet switch)**连接到一起，链路的**传输速率(transmission rate)**即带宽以**比特/秒(bit/s,或 bps)**度量。

当一台端系 统要向另一台端系统发送数据时，发送端系统将数据分段，并为每段加上首部字节。由此 形成的信息包用计算机网络的术语来说称为**分组(packet)**。这些分组通过网络发送到目的端系统，在那里被装配成初始数据。

分组交换机从它的一条入通信链路接收到达的分组，并从它的一条出通信链路转发该分组

但在当今的因特网中，两种最著名分组交换机的类型是**路由器(router)**和**链路层交换机(link-layer switch)**。这两种类型的交换机朝着最终目的地转发分组。**链路层交换机**通常用于**接入网**中，而路由器通常用于**网络核心**中。从发送端系统到接收端系统，一个分组所经历的一系列**通信链路**和**分组交换机**称为通过该网络的**路径(mute 或 path)**。

端系统通过**因特网服务提供商(Internet Service Provider, ISP)** 接入因特网，ISP 也为内容提供者提供因特网接入服务，将 Web 站点和视频服务器直接连入因特网。因特网就是将端系统彼此互联，因此为端系统提供接入的 ISP 也必须互联。

端系统、分组交换机和其他因特网部件都要运行一系列**协议(protocol)**, 这些协议控制因特网中信息的接收和发送。

**因特网标准(Internet standard)** 由因特网工程任务组(Internet Engineering Task Force, IETF ) [IETF 2016]研发。IETF 的标准文档称为请求评论(Request For Comment, RFC)。

**节点**

- 主机及其上运行的应用程序
- 路由器、交换机等网络交换设备
  **边:通信链路**
- 接入网链路:主机连接到互联网的链路
- 主干链路:路由器间的链路

**_从为应用程序提供服务的基础设施_** 的角度来描述因特网

- 使用通信设施进行通信的分布式应用程序
- 通信基础设施为 apps 提供通信接口

因为这些应用程序涉及多个相互交换数据的端系统，故它们被称为**分布式应用程序(distributed applicalion)**

与因特网相连的端系统提供了一个**套接字接口(socket interface)**,该接口规定了运行在一个端系统上的程序请求因特网基础设施向运行在另一个端系统上的特定目的地程序交付数据的方式。因特网套接字接口是一套发送程序必须遵循的规则集合，因此因特网能够将数据交付给目的地。

## 2. 什么是协议

网络协议类似于人类协议，除了交换报文和采取动作的实体是某些设备的硬件或软件组件。在因特网中，涉及两个或多个**远程通信实体**的所有活动都受**协议**的制约

**协议(protocol)** 定义了在两个或多个通信实体之间交换的报文的格式和顺序，以及报文发送和/或接收一条报文或其他事件所采取的动作。

因特网(更一般地说是计算机网络)广泛地使用了协议。不同的协议用于完成不同的通信任务。

## 3. 网络边缘

### 3.1 接入网

通常把与因特网相连的计算机和其他设备称为**端系统**。因为它们位于因特网的**边缘**，故而被称为**端系统**。

端系统也称为**主机(host)**，即主机 = 端系统。主机有时又被进一步划分为两类:客户端(client)和服务器(server)。服务器大都属于大型**数据中心(data center)**。

**接入网**是指将**端系统**物理连接到其**边缘路由器(edge router)**的网络。**边缘路由器**是**端系统**到任何其他远程**端系统**的路径上的第一台路由器。

宽带住宅接入有两种最流行的类型:**数字用户线(Digital Subscriber Line, DSL)** 和**电缆**。

**电缆因特网接入(cable Internet access)** 利用了有线电视公司现有的有线电视基础设施。在这个系统中应用了光纤和同轴电缆，所以它经常被称为**混合光纤同轴(Hybrid Fiber Coax, HFC)**系统。

电缆因特网接入需要特殊的调制解调器，这种调制解调器称为**电缆调制解调器(cable modem)**。在电缆头端，**电缆调制解调器端接系统(Cable Modem Termination System, CMTS)**与 DSL 网络的 DSLAM 具有类似的功能，即将来自许多下行家庭中的电缆调制解调器发送的模拟信号转换回数字形式。电缆调制解调器将 HFC 网络划分为下行和上行两个信道。

但一种提供更高速率的新兴技术是**光纤到户(Fiber To The Home, FTTH)** [FTTH Council 2016]。顾名思义, FTTH 概念简单，从本地中心局直接到家庭提供了一条光纤路径。

一般的是，从中心局岀来的每根光纤实际上由许多家庭共享，直到相对接近这些家庭的位置，该光纤才分成每户一根光纤。进行这种分配有两种有竞争性的光纤分布体系结构: **主动光纤网络(Active Optical Network, AON)**和**被动光纤网络(Passive Optical Network, P0N)**。AON 本质上就是交换因特网。

PON 分布体系结构的 FTTH，每个家庭具有一个**光纤网络端接器(Optical Network Termi・nator, ONT)**,它由专门的光纤连接到邻近的**分配器(splitter)**。

FTTH 有潜力提供**每秒千兆比特**范围的因特网接入速率。

### 3.2 物理媒体

当从源到目的地传输时，比特会通过一系列“发射器-接收器”对。对于每个发射器-接收器对, 通过跨越一种**物理媒体(physical medium)**传播电磁波或光脉冲来发送该比特。

物理媒体分成两种类型:**导引型媒体(guided media)**和**非导引型媒体(unguided media)**。对于导引型媒体, 电波沿着固体媒体前行，对于非导引型媒体，电波在空气或外层空间中传播。

- **无屏蔽双绞线(Unshielded Twisted Pair, UTP)** 常用在建筑物内的计算机网络中，即用于 **局域网(LAN)** 中。目前局域网中的双绞线的数据速率从 10Mbps 到 10Gbps。所能达到的数据传输速率取决于线的粗细以及传输方和接收方之间的距离。
- **同轴电缆**能被用作**导引型共享媒体(shared medium)**。
- **光纤**是一种细而柔软的、能够导引光脉冲的媒体。速率高，不受电磁干扰，衰减极低，并且很难窃听。
- **陆地无线电信道**：WIFI 和蜂窝网络等
- **卫星无线电信道**：通信中常使用两类卫星:**同步卫星(geostationary satellite)**和**近地轨道(Low・Earth Orbiting, LEO)卫星** 。

## 4. 网络核心

**网络核心**，即由互联因特网端系统的**分组交换机**和**链路**构成的网状网络（路由器的网状网络）。

### 4.1 分组交换

在各种网络应用中，端系统彼此交换**报文(message)**。报文能够包含协议设计者需要的任何东西。为了从源端系统向目的端系统发送一个报文，源将长报文划分为较小的数据块，称之为**分组 (packet)**。在源和目的地之间，每个分组都通过**通信链路**和**分组交换机(packet switch)** 传送。(交换机主要有两类:**路由器(router)**和**链路层交换机(link-layer switch)**)分组以等于该链路最大传输速率的速度传输通过通信链路。

如果某源端系统或分组交换 机经过一条链路发送一个厶比特的分组，链路的传输速率为尺比特/秒，则传输该分组的时间为 L/R 秒。

- 路由: 决定分组采用的源到 目标的路径
- 转发: 将分组从路由器的输 入链路转移到输出链路

1. 存储转发传输

多数分组交换机在链路的输入端使用存储转发传输(store-and-forward transmission)机制。存储转发传输是指在交换机能够开始向输岀链路传输该分组的第一个比特之前，必须接收到整个分组。仅当路由器已经接收完了该分组的所有比特后，它才能开始向出链路传输(即“转发”)该分组。

通过由 N 条速率均为 R 的链路组成的路径(所以,在源和目的地之间有 N-1 台路由器)，从源到目的地发送一个分组。应用如上相同的逻辑，我们看到端到端时延是: d = N\*L/R

2. 排队时延+分组丢失

每台分组交换机有多条链路与之相连。对于每条相连的链路，该分组交换机具有一个 **输出缓存(output buffer,也称为输出队列(output queue))**,它用于存储路由器准备发往 那条链路的分组。该输出缓存在分组交换中起着重要的作用。如果到达的分组需要传输到某条链路，但发现该链路正忙于传输其他分组，该到达分组必须在输出缓存中等待。因此，除了存储转发时延以外，分组还要承受输岀缓存的**排队时延(queuing delay)**。这些时 延是变化的，变化的程度取决于网络的拥塞程度。因为缓存空间的大小是有限的，一个到达的分组可能发现该缓存已被其他等待传输的分组完全充满了。在此情况下，将出现**分组丢失(丢包)(packet loss)**,到达的分组或已经排队的分组之一将被丢弃。

3. 转发表和路由选择协议

路由器从与它相连的一条通信链路得到分组，然后向与它相连的另一 条通信链路转发该分组。

每个端系统具有一个称为**IP 地址**的地址。当源主机要向目的端系统发送一个分组时，源在该分组的首部包含了目的地的 IP 地址。当一个分组到达网络中的路由器时，路由器检查该分组的目的地址的一部分，并向一台相邻路由器转发该分组。更特别的是，每台路由器具有一个**转发表(forwarding table)**,用于将目的地址(或目的地址的一部分)映射成为**输岀链路**。当某分组到达一台路由器时，路由器检查该地址，并用这个目的地址搜索其转发表，以发现适当的出链路。路由器则将分组导向该出链路。

因特网具有一些特殊的**路由选择协议(routing protocol)**,用于自动地设置这些转发表。

### 4.2 电路交换

通过网络链路和交换机移动数据有两种基本方法:**电路交换(circuit switching)**和**分组交换(packet switching)**。

在电路交换网络中，在端系统间通信会话期间，预留了端系统间沿路径通信所需要的资源(缓存，链路传输速率)。在分组交换网络中，这些资源则不是预留的；会话的报文按需使用这些资源，其后果可能是不得不等待(即排队)接入通信线路。

端到端的资源被分配给从源端 到目标端的呼叫 “call”

每台主机(例如 PC和工作站)都与一台交换机直接相连。当两台主机要通信时，该网络在两台主机之间创建一条专用的端到端连接(end-to-end connection)。

如果呼叫没有数据发送，被分配的资源就会被浪费。

1. 电路交换网络中的复用

链路中的电路是通过**频分复用(Frequency- Division Multiplexing, FDM)** 或**时分复用(Time-Division Multiplexing, TDM)** 来实现的。

- 对于FDM,链路的频谱由跨越链路创建的所有连接共享。
- 对于一条TDM链路，时间被划分为固定期间的帧，并且每个帧又被划分为固定数量的时隙。当网络跨越一条链路创建一条连接时.网络在每个帧中为该连接指定一个时隙。这些时隙专门由该连接单独使用，一个时隙(在每个帧内)可用于传输该连接的数据。

电路交换不适合计算机之间的通信

- 连接建立时间长
- 计算机之间的通信有突发性，如果使用线路交换，则浪费的片较多
- 即使这个呼叫没有数据传递，其所占据的片也不能够被别的呼叫使用
- 可靠性不高?
